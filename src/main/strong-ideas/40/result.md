Система -- бэкенд для приложения мобильного банка.

**Пять ключевых свойств системы**

1. **Доступность**
   
      Описание: гарантия, что система доступна для пользователей в любое время
   
      Узкий диапазон: >= 99.99%
      
      Широкий диапазон: >= 99.9%
   
      Инвариант (диапазон совпадает с ранее указанным): STABLE (выбираем этот инвариант с учетом резервирования компонентов системы и выбранной ширины диапазона, т.е. статистики, хотя, конечно, из-за аномально увеличившихся продолжительности и/или частоты сбоев инвариант может быть переведен в RESILIENT)


2. **Время отклика**

   Описание: среднее время обработки запроса в разрезе endpoint (успешный результат на запрос не гарантируется)

   Узкий диапазон: <= 1s 

   Широкий диапазон: <= 10s

   Инвариант (диапазон совпадает с ранее указанным): если рассматривать со стороны клиента, то STRONG (ограничение сверху в 10s на время отклика устанавливается на клиенте), но если говорить о времени ответа бэк-системы, то -- RESILIENT, так как время ответа не ограничено


3. **Количество входов в мобильное приложение**

   Описание: количество входов пользователей в мобильное приложение в минуту, которое должен выдержать backend

   Узкий диапазон: >= 60000

   Широкий диапазон: >= 10000

   Инвариант (диапазон совпадает с ранее указанным): RESILIENT (причина, почему не можем поставить более строгий инвариант -- невозможность входа в приложение в момент глобального сбоя)


4. **Среднее время отображения главного экрана мобильного приложения**

   Описание: время, которое необходимо backend'у для формирования ответа для отображения главного экрана мобильного приложения

   Узкий диапазон: <= 0,5s

   Широкий диапазон: <= 1s

   Инвариант (диапазон совпадает с ранее указанным): STABLE (то же, что в 1)


5. **Процент успешных запросов**

   Описание: доля успешно завершенных запросов в разрезе endpoint

   Узкий диапазон: >= 99%

   Широкий диапазон: >= 95%

   Инвариант (диапазон совпадает с ранее указанным): STABLE (то же, что в 1)

Каждый из этих инвариантов можно усилить, но выражаться это будет скорее не в переходе от STABLE и RESILIENT к более строгим инвариантам, а в сужении диапазона. Добиться сужения диапазона можно путем увеличения стоимости разработки и сопровождения системы. Например, большее резервирование, более частое проведение нагрузочного тестирования, проведения обучений и учений среди функционального сопровождения. Это же касается и скорости восстановления системы.

**Вывод**

Для чего нужно понимать надежность своей системы? В основном для того, чтобы планировать свою текущую работу (предоставить клиентам приемлемый уровень сервиса) и сравнивать себя с конкурентами (предоставить клиентам лучший уровень сервиса, чем у них), что можно объединить при разговоре о коммерческих проектах в "чтобы заработать больше денег".

В попытках формализовать понятие надежности системы и оценить в соответствии с ним саму систему мы, как и было сказано в статье, в итоге приходим к:

1) комбинации RESILIENT и/или STABLE с диапазонами;
2) либо, что еще хуже с точки зрения информативности, просто к RESILIENT.

Что является причиной? Мы не можем не учитывать бесконечное разнообразие и влияние внешних и внутренних факторов. А эти факторы всегда будут, нам от них не деться ни на локальной машине, ни в большой геораспределенной системе. К сожалению, их влияние может и в худшем случае будет фатальным, так что мы не можем приблизиться к STRONG и TRIPWIRE.

Но можем ли мы формализовать влияние различных факторов, чтобы хотя бы правильно рассчитывать ширину диапазона RESILIENT и/или STABLE? Мы не можем учесть все из них, поэтому в первую очередь нужно ограничить круг наиболее весомых. Это уже является значительным допущением. Далее каждому фактору сопоставим численную метрику, которую будем использовать для сбора статистики. Если мы хотим, например, начать измерять опыт наших SRE, то вводим новую метрику и определяем ее влияние на диапазон. Выглядит, как плохо масштабируемая история: нужно будет придумать сложную функцию, которая корректно отразит влияние всех метрик.

Посмотрим на проблему с другого ракурса. Что если попробовать использовать наше формальное определение для сравнения надежности двух и более систем? Равная надежность двух систем по одному и тому же критерию ничего не говорит о реальном положении дел. Чем нагруженнее (приносит больше денег) система, тем более строгие требования к ней будут предъявляться. Одновременно с этим, если разработанная быть нагруженной дорогая система еще толком не эксплуатировалась, то говорить о ее надежности нет смысла. Если же мы собрали статистику за длинный период (хотя бы полгода-год) на нагрузке, которая оправдывает вложенные в систему средства, то к таким доводам можно отнестись более серьезно. Также на показатель надежности очень сильно повлияют частота и масштабность воспроизведения внешних факторов. Например, если на наш сервис постоянно совершаются ddos-атаки, а мы им можем противостоять, то это подтверждает полученную оценку надежности. Если же таких инцидентов еще не возникало, то мы достоверно не можем сказать о надежности системы. Мы можем это лишь предполагать, что не очень похоже на формальный подход.

Кажется, что, пытаясь загнать оценки в узкие рамки, предложенные Hillel Wayne мы теряем и в информативности и не получаем формализованного решения. Даже если мы выводим такую оценку, то очень непонятно, что делать с ней в будущем. Мне видится более полезным все же оставаться в терминах сбора статистики и ретроспективной оценки, когда мы видим динамику изменения метрик вкупе с историей возникавших инцидентов.